{
  "connectors": {
    "nuix": {
      "exeConsolePath": "C:\\Program Files\\Nuix\\Nuix 8.8\\nuix_console.exe",
      "licencesourcetype": "dongle",
      "version": "8.8",

      "features": [
        "ANALYSIS",
        "CASE_CREATION",
        "EXPORT_ITEMS",
        "METADATA_IMPORT",
        "OCR_PROCESSING",
        "PRODUCTION_SET"
      ]
    }
  },
  "nlog": {
    "throwConfigExceptions": true,
    "extensions": [{ "assembly": "NLog.Targets.ElasticSearch" }],
    "targets": {
      "jsonTarget": {
        "type": "File",
        "fileName": "${basedir:fixtempdir=true}\\edr.log.json",
        "layout": {
          "type": "JsonLayout",
          "Attributes": [
            {
              "name": "level",
              "layout": "${level}"
            },
            {
              "name": "ts",
              "layout": "${date}"
            },
            {
              "name": "caller",
              "layout": "${when:when='${event-properties:item=StepName}'=='':inner=${event-properties:Location}:else=${event-properties:StepName}}"
            },
            {
              "name": "msg",
              "layout": "${message}"
            },
            {
              "name": "properties",
              "encode": false,
              "layout": {
                "type": "JsonLayout",
                "includeallproperties": "true"
              }
            }
          ]
        }
      },
      "fileTarget": {
        "type": "File",
        "fileName": "${basedir:fixtempdir=true}\\edr.log",
        "layout": "${date} ${level:uppercase=true} ${message} ${exception}"
      },
      "consoleInfo": {
        "type": "Console",
        "layout": "${date} ${message}"
      },
      "consoleError": {
        "type": "Console",
        "layout": "${date} ${level:uppercase=true} ${message}",
        "error": true
      },
      "elastic": {
        "type": "BufferingWrapper",
        "flushTimeout": "5000",
        "target": {
          "type": "ElasticSearch",
          "uri": "http://localhost:9200",
          "index": "edr-${date:format=yyyy.MM.dd}",
          "includeAllProperties": true
        }
      }
    },
    "rules": [
      {
        "logger": "*",
        "minLevel": "Error",
        "writeTo": "fileTarget,consoleError,jsonTarget,elastic",
        "final": true
      },
      {
        "logger": "*",
        "minLevel": "Info",
        "writeTo": "consoleInfo"
      },
      {
        "logger": "*",
        "minLevel": "Debug",
        "writeTo": "fileTarget,jsonTarget,elastic"
      }
    ]
  }
}
